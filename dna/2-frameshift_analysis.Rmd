---
title: "2-frameshift_analysis"
author: "Matthew Beaumont"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# SF DeviaTE - Int del freq analysis -

```{R}
library(dplyr)
library(tidyr)
library(ggplot2)
library(purrr)
library(stringr)

column_names <- c(
  "TEfam", "sample_id", "pos", "refbase", "A", "C", "G", "T", "cov", "phys_cov", 
  "hq_cov", "snp", "refsnp", "int_del", "int_del_freq", "trunc_left", "trunc_right", 
  "ins", "delet", "annotation"
)

data <- read.table(
  "/Volumes/Data/Tools/teminer-code/results/sf_mel/deviate/PPI251/all_sf_merged.raw",
  header = FALSE, 
  sep = " ", 
  stringsAsFactors = FALSE, 
  col.names = column_names, 
  fill = TRUE,
  comment.char = "#"
)
data <- data %>%
  mutate(sample_name = gsub(".*/(.*)\\.allte\\.sort\\.bam", "\\1", sample_id))

# Filter by replicate
data_r1 <- data %>%
  filter(grepl("R1", sample_name))

data_r2 <- data %>%
  filter(grepl("R2", sample_name))

data_r3 <- data %>%
  filter(grepl("R3", sample_name))

# Combine datasets
combined_data <- bind_rows(
  data_r1 %>% mutate(replicate = "R1"),
  data_r2 %>% mutate(replicate = "R2"),
  data_r3 %>% mutate(replicate = "R3")
)

cleaned_data <- combined_data %>%
  select(TEfam, replicate, pos, int_del)

cleaned_data <- cleaned_data %>%
  filter(
    !is.na(int_del))

# Parse truncation columns and form pairs
truncation_pairs <- cleaned_data %>%
  mutate(
    int_del_parsed = map(int_del, function(trunc_col) {
      # Split by commas
      trunc_values <- str_split(trunc_col, ",")[[1]]
      
      # Extract start, end, and freq
      truncation_data <- map_dfr(trunc_values, function(value) {
        parts <- str_split(value, ":")[[1]]
        
        if (length(parts) == 3) {
          tibble(
            trunc_start = as.integer(parts[1]),
            trunc_end = (as.integer(parts[2]) - 1),
            freq = as.numeric(parts[3])
          )
        } else {
          tibble(trunc_start = integer(), trunc_end = integer(), freq = numeric())
        }
      })
      
      truncation_data
    })
  ) %>%
  unnest(int_del_parsed)

# Merge trunc pairs with the same start/end
merged_truncation_pairs <- truncation_pairs %>%
  group_by(replicate, trunc_start, trunc_end) %>% 
  summarise(freq = mean(freq, na.rm = TRUE), .groups = "drop")

#  Filter for low freq
trunc_pairs_fil <- merged_truncation_pairs %>%
  filter(freq >= 40)

# Calculate the average HQ coverage for each position within each replicate
average_hq_cov <- combined_data %>%
  group_by(pos, replicate) %>%
  summarise(avg_hq_cov = mean(hq_cov, na.rm = TRUE), .groups = "drop")

plot_avg <- ggplot(average_hq_cov, aes(x = pos, y = avg_hq_cov)) +
  geom_line(size = 1, color = "black") +
  geom_rect(
    data = trunc_pairs_fil,
    aes(
      xmin = trunc_start, 
      xmax = trunc_end, 
      ymin = -Inf, 
      ymax = Inf
    ),
    fill = "blue", 
    alpha = 0.1,
    inherit.aes = FALSE
  ) +
  labs(
    x = "Position", 
    y = "Average High-Quality Coverage", 
    shape = "Truncation"
  ) +
  facet_wrap(~ replicate, scales = "fixed") +
  theme_minimal() +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(), 
    panel.border = element_rect(color = "black", fill = NA, size = 1),
    strip.background = element_rect(fill = "grey80", color = "black"),
    strip.text = element_text(size = 10),
    panel.spacing = unit(0.4, "lines"),
    legend.position = "bottom",
    legend.direction = "horizontal"
  )

print(plot_avg)

ggsave("figs/dmel_deviate_avg_raw_40.png", plot_avg, width = 26, height = 5, dpi = 400)
ggsave("figs/dmel_deviate_avg_raw_40.svg", plot_avg, width = 26, height = 5)
```

## Proportion analysis - 

```{R}
library(dplyr)
library(tidyr)
library(ggplot2)
library(purrr)
library(stringr)

column_names <- c(
  "TEfam", "sample_id", "pos", "refbase", "A", "C", "G", "T", "cov", "phys_cov", 
  "hq_cov", "snp", "refsnp", "int_del", "int_del_freq", "trunc_left", "trunc_right", 
  "ins", "delet", "annotation"
)

data <- read.table(
  "/Volumes/Data/Tools/teminer-code/results/sf_mel/deviate/PPI251/all_sf_merged.PPI251",
  header = FALSE, 
  sep = " ", 
  stringsAsFactors = FALSE, 
  col.names = column_names, 
  fill = TRUE,
  comment.char = "#"
)
data <- data %>%
  mutate(sample_name = gsub(".*/(.*)\\.allte\\.sort\\.bam", "\\1", sample_id))

# Filter by replicate
data_r1 <- data %>%
  filter(grepl("R1", sample_name))

data_r2 <- data %>%
  filter(grepl("R2", sample_name))

data_r3 <- data %>%
  filter(grepl("R3", sample_name))

# Combine datasets
combined_data <- bind_rows(
  data_r1 %>% mutate(replicate = "R1"),
  data_r2 %>% mutate(replicate = "R2"),
  data_r3 %>% mutate(replicate = "R3")
)

cleaned_data <- combined_data %>%
  select(TEfam, replicate, pos, int_del)

cleaned_data <- cleaned_data %>%
  filter(
    !is.na(int_del))

# Parse truncation columns and form pairs
truncation_pairs <- cleaned_data %>%
  mutate(
    int_del_parsed = map(int_del, function(trunc_col) {
      # Split by commas
      trunc_values <- str_split(trunc_col, ",")[[1]]
      
      # Extract start, end, and freq
      truncation_data <- map_dfr(trunc_values, function(value) {
        parts <- str_split(value, ":")[[1]]
        
        if (length(parts) == 3) {
          tibble(
            trunc_start = as.integer(parts[1]),
            trunc_end = (as.integer(parts[2]) - 1),
            freq = as.numeric(parts[3])
          )
        } else {
          tibble(trunc_start = integer(), trunc_end = integer(), freq = numeric())
        }
      })
      
      truncation_data
    })
  ) %>%
  unnest(int_del_parsed)

# Merge trunc pairs with the same start/end
merged_truncation_pairs <- truncation_pairs %>%
  group_by(replicate, trunc_start, trunc_end) %>% 
  summarise(freq = mean(freq, na.rm = TRUE), .groups = "drop")

# Filter for low freq
trunc_pairs_fil <- merged_truncation_pairs %>%
  filter(freq >= 0.9)

# Filter edges due to low coverage - could do +-100bp also (1 read length)
combined_data <- combined_data %>%
  filter(pos > 49 & pos < max(pos) - 50)

### Coverage Calculation ###

# Calculate min and max hq_cov for each sample within each replicate
min_max_per_sample <- combined_data %>%
  group_by(sample_name, replicate) %>%
  summarise(
    min_hq_cov_sample = min(hq_cov, na.rm = TRUE),
    max_hq_cov_sample = max(hq_cov, na.rm = TRUE),
    .groups = "drop"
  )

# Calculate the average min and max across all samples for each replicate
avg_min_max_per_replicate <- min_max_per_sample %>%
  group_by(replicate) %>%
  summarise(
    avg_min_hq_cov = mean(min_hq_cov_sample, na.rm = TRUE),
    avg_max_hq_cov = mean(max_hq_cov_sample, na.rm = TRUE),
    .groups = "drop"
  )

# Calculate average hq_cov outside truncation windows for each replicate
average_hq_cov_outside_truncs <- combined_data %>%
  # Exclude positions within truncation windows defined in trunc_pairs_fil
  filter(
    !purrr::map_lgl(
      combined_data$pos, 
      function(pos) any(
        trunc_pairs_fil$trunc_start <= pos & pos <= trunc_pairs_fil$trunc_end
      )
    )
  ) %>%
  group_by(replicate) %>%
  summarise(
    average_hq_cov_outside_truncs = mean(hq_cov, na.rm = TRUE),
    .groups = "drop"
  )

# Merge the new average hq_cov outside truncation windows with the avg_min_max_per_replicate
avg_min_max_with_hq_outside <- avg_min_max_per_replicate %>%
  left_join(average_hq_cov_outside_truncs, by = "replicate")

write.table(
  avg_min_max_with_hq_outside, 
  "figs/avg_min_max_with_hq_outside_truncs.txt", 
  sep = "\t", 
  row.names = FALSE, 
  quote = FALSE
)

print(trunc_pairs_fil)
print(avg_min_max_with_hq_outside)


# Merge trunc_pairs_fil with average_hq_cov_outside_truncs based on replicate
trunc_pairs_with_avg_hq_cov <- trunc_pairs_fil %>%
  left_join(average_hq_cov_outside_truncs, by = "replicate")

# Add a new column that divides the frequency by the average hq_cov outside of windows
trunc_pairs_with_avg_hq_cov <- trunc_pairs_with_avg_hq_cov %>%
  mutate(freq_to_avg_hq_cov_ratio = freq / average_hq_cov_outside_truncs)

write.table(
  trunc_pairs_with_avg_hq_cov, 
  "figs/trunc_pairs_with_avg_hq_cov_ratio.txt", 
  sep = "\t", 
  row.names = FALSE, 
  quote = FALSE
)

print(trunc_pairs_with_avg_hq_cov)

```

## Editing raw fasta

```{R, eval = FALSE}
library(Biostrings)

fasta_file <- "/Volumes/Data/Projects/dmelR2_p-ele/R/dna/data/pele_fasta/PPI251_spliced.fasta"
fasta <- readDNAStringSet(fasta_file)

sequence <- as.character(fasta[[1]])
header <- names(fasta)[1]

remove_start <- 663  # start position
remove_end <-   2170  # end position

remaining_sequence <- paste0(
  substr(sequence, 1, remove_start),
  substr(sequence, remove_end, nchar(sequence))
)

output_fasta <- "/Volumes/Data/Projects/dmelR2_p-ele/R/dna/data/pele_fasta/PPI251_KP.fasta"
writeLines(c(paste0(">", header), remaining_sequence), con = output_fasta)
cat("New FASTA file saved to:", output_fasta, "\n")
```

# Frameshift calcs

We start with the canonical nucleotide sequence of the P-element in Drosophila melanogaster:

```{bash, eval=FALSE}
>PPI251
CATGATGAAATAACATAAGGTGGTCCCGTCGAAAGCCGAAGCTTACCGAAGTATACACTTAAATTCAGTGCACGTTTGCTTGTTGAGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTACGTGGAATAAAAAAAAATGAAATATTGCAAATTTTGCTGCAAAGCTGTGACTGGAGTAAAATTAATTCACGTGCCGAAGTGTGCTATTAAGAGAAAATTGTGGGAGCAGAGCCTTGGGTGCAGCCTTGGTGAAAACTCCCAAATTTGTGATACCCACTTTAATGATTCGCAGTGGAAGGCTGCACCTGCAAAAGGTCAGACATTTAAAAGGAGGCGACTCAACGCAGATGCCGTACCTAGTAAAGTGATAGAGCCTGAACCAGAAAAGATAAAAGAAGGCTATACCAGTGGGAGTACACAAACAGAGTAAGTTTGAATAGTAAAAAAAATCATTTATGTAAACAATAACGTGACTGTGCGTTAGGTCCTGTTCATTGTTTAATGAAAATAAGAGCTTGAGGGAAAAAATTCGTACTTTGGAGTACGAAATGCGTCGTTTAGAGCAGCAGCTGAGGGAGTCTCAACAGTTGGAGGAGTCTCTACGCAAAATCTTCACGGACACGCAGATACGGATACTGAAGAATGGTGGACAAAGAGCTACGTTCAATTCCGACGACATTTCTACAGCTATTTGTCTCCACACCGCAGGCCCTCGAGCGTATAACCATCTGTACAAAAAAGGATTTCCTTTGCCCAGTCGTACGACTTTGTACAGATGGTTATCAGATGTGGACATAAAAAGAGGATGTTTGGATGTGGTCATAGACCTAATGGACAGTGATGGAGTTGATGACGCCGACAAGCTTTGCGTACTCGCTTTCGACGAGATGAAGGTCGCTGCTGCCTTCGAGTATGACAGCTCTGCTGATATTGTTTACGAGCCAAGCGACTATGTCCAACTGGCTATTGTTCGTGGTCTAAAAAAATCGTGGAAGCAGCCAGTTTTTTTCGATTTTAATACCCGAATGGACCCGGATACTCTTAACAATATATTAAGGAAACTGCATAGGAAAGGATATTTAGTAGTTGCTATTGTATCCGATTTAGGTACCGGAAACCAAAAGCTATGGACAGAGCTCGGTATATCAGAATGTAAGTTTCGTATATTACAAAAATCAGATAATCCTTGAAATTCCATTTTTTAGCAAAAACCTGGTTTAGCCATCCTGCAGATGACCATTTAAAGATTTTCGTTTTTTCGGATACGCCACATTTAATTAAGTTAGTCCGTAACCACTATGTGGATTCCGGATTAACAATAAATGGGAAAAAATTAACAAAAAAAACAATTCAGGAGGCACTTCATCTTTGCAACAAGTCCGATCTGTCTATCCTCTTTAAAATTAATGAAAATCACATTAATGTTCGATCGCTCGCAAAACAGAAGGTTAAATTGGCTACCCAGCTGTTTTCGAATACCACCGCTAGCTCGATCAGACGCTGCTATTCATTGGGGTATGACATTGAAAATGCCACCGAAACTGCGGACTTCTTCAAATTGATGAATGATTGGTTCGACATTTTTAATTCTAAATTGTCCACATCCAATTGCATTGAGTGCTCGCAACCTTATGGCAAGCAGTTGGATATACAGAATGATATTTTGAATCGAATGTCGGAAATTATGCGAACAGGAATTCTGGATAAACCCAAAAGGCTCCCATTTCAAAAAGGTATCATTGTGAATAATGCTTCGCTTGATGGCTTGTATAAATATTTGCAAGAAAACTTCAGTATGCAATACATATTAACAAGCCGTCTCAACCAAGACATTGTGGAGCATTTTTTTGGCAGCATGCGATCGAGAGGTGGACAATTCGACCATCCCACTCCACTGCAGTTTAAGTATAGGTTAAGAAAATATATAATAGGTATGACAAATTTAAAAGAATGCGTAAACAAAAATGTAATTCCATGATTTATAATTGTTTAATGTTTAGCTATATGTTTCAGGAAAGTTTCAGTTGAGAATGTAGGTAGTTATGTGCTGTCTATTGTGTTTTGTCTTTTATCTGTTTCTTTTCATTTTATTATTTAATCATTATCCTTTTGCTTATCCAGCCAGGAATACAGAAATGTTAAGAAATTCGGGAAATATCGAAGAGGACAACTCTGAAAGCTGGCTTAATTTAGATTTCAGTTCTAAAGAAAACGAAAATAAAAGTAAAGATGATGAGCCTGTCGATGATGAGCCTGTCGATGAGATGTTAAGCAATATAGATTTCACCGAAATGGATGAGTTGACGGAGGATGCGATGGAATATATCGCGGGCTATGTCATTAAAAAATTGAGAATCAGTGACAAAGTAAAAGAAAATTTGACATTTACATACGTCGACGAGGTGTCTCACGGCGGACTTATTAAGCCGTCCGAAAAATTTCAAGAGAAGTTAAAAGAGCTAGAATGTATTTTTTTGCATTATACAAATAATAATAATTTTGAAATTACAAATAATGTAAAGGAAAAATTAATATTAGCAGCGCGAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTTTAAAAATAATTTCGTCTAATTAATATTATGAGTTAATTCAAACCCCACGGACATGCTAAGGGTTAATCAACAATCATATCGCTGTCTCACTCAGACTCAATACGACACTCAGAATACTATTCCTTTCACTCGCACTTATTGCAAGCATACGTTAAGTGGATGTCTCTTGCCGACGGGACCACCTTATGTTATTTCATCATG
```

We can then extract the sequence of the known ORF locations:

```{bash, eval=FALSE}
Exon-0:	85-442
Exon-1:	501-1168
Exon-2:	1222-1947
Exon-3:	2138-2709
```

We are then left with just the post-splicing P-element sequence:

```{bash, eval=FALSE}
>PPI251-spliced
>Exon-0
GAGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTACGTGGAATAAAAAAAAATGAAATATTGCAAATTTTGCTGCAAAGCTGTGACTGGAGTAAAATTAATTCACGTGCCGAAGTGTGCTATTAAGAGAAAATTGTGGGAGCAGAGCCTTGGGTGCAGCCTTGGTGAAAACTCCCAAATTTGTGATACCCACTTTAATGATTCGCAGTGGAAGGCTGCACCTGCAAAAGGTCAGACATTTAAAAGGAGGCGACTCAACGCAGATGCCGTACCTAGTAAAGTGATAGAGCCTGAACCAGAAAAGATAAAAGAAGGCTATACCAGTGGGAGTACACAAACAG
>Exon-1
TCCTGTTCATTGTTTAATGAAAATAAGAGCTTGAGGGAAAAAATTCGTACTTTGGAGTACGAAATGCGTCGTTTAGAGCAGCAGCTGAGGGAGTCTCAACAGTTGGAGGAGTCTCTACGCAAAATCTTCACGGACACGCAGATACGGATACTGAAGAATGGTGGACAAAGAGCTACGTTCAATTCCGACGACATTTCTACAGCTATTTGTCTCCACACCGCAGGCCCTCGAGCGTATAACCATCTGTACAAAAAAGGATTTCCTTTGCCCAGTCGTACGACTTTGTACAGATGGTTATCAGATGTGGACATAAAAAGAGGATGTTTGGATGTGGTCATAGACCTAATGGACAGTGATGGAGTTGATGACGCCGACAAGCTTTGCGTACTCGCTTTCGACGAGATGAAGGTCGCTGCTGCCTTCGAGTATGACAGCTCTGCTGATATTGTTTACGAGCCAAGCGACTATGTCCAACTGGCTATTGTTCGTGGTCTAAAAAAATCGTGGAAGCAGCCAGTTTTTTTCGATTTTAATACCCGAATGGACCCGGATACTCTTAACAATATATTAAGGAAACTGCATAGGAAAGGATATTTAGTAGTTGCTATTGTATCCGATTTAGGTACCGGAAACCAAAAGCTATGGACAGAGCTCGGTATATCAGAA
>Exon-2
AAAAACCTGGTTTAGCCATCCTGCAGATGACCATTTAAAGATTTTCGTTTTTTCGGATACGCCACATTTAATTAAGTTAGTCCGTAACCACTATGTGGATTCCGGATTAACAATAAATGGGAAAAAATTAACAAAAAAAACAATTCAGGAGGCACTTCATCTTTGCAACAAGTCCGATCTGTCTATCCTCTTTAAAATTAATGAAAATCACATTAATGTTCGATCGCTCGCAAAACAGAAGGTTAAATTGGCTACCCAGCTGTTTTCGAATACCACCGCTAGCTCGATCAGACGCTGCTATTCATTGGGGTATGACATTGAAAATGCCACCGAAACTGCGGACTTCTTCAAATTGATGAATGATTGGTTCGACATTTTTAATTCTAAATTGTCCACATCCAATTGCATTGAGTGCTCGCAACCTTATGGCAAGCAGTTGGATATACAGAATGATATTTTGAATCGAATGTCGGAAATTATGCGAACAGGAATTCTGGATAAACCCAAAAGGCTCCCATTTCAAAAAGGTATCATTGTGAATAATGCTTCGCTTGATGGCTTGTATAAATATTTGCAAGAAAACTTCAGTATGCAATACATATTAACAAGCCGTCTCAACCAAGACATTGTGGAGCATTTTTTTGGCAGCATGCGATCGAGAGGTGGACAATTCGACCATCCCACTCCACTGCAGTTTAAGTATAGGTTAAGAAAATATATAATA
>Exon-3
CAGGAATACAGAAATGTTAAGAAATTCGGGAAATATCGAAGAGGACAACTCTGAAAGCTGGCTTAATTTAGATTTCAGTTCTAAAGAAAACGAAAATAAAAGTAAAGATGATGAGCCTGTCGATGATGAGCCTGTCGATGAGATGTTAAGCAATATAGATTTCACCGAAATGGATGAGTTGACGGAGGATGCGATGGAATATATCGCGGGCTATGTCATTAAAAAATTGAGAATCAGTGACAAAGTAAAAGAAAATTTGACATTTACATACGTCGACGAGGTGTCTCACGGCGGACTTATTAAGCCGTCCGAAAAATTTCAAGAGAAGTTAAAAGAGCTAGAATGTATTTTTTTGCATTATACAAATAATAATAATTTTGAAATTACAAATAATGTAAAGGAAAAATTAATATTAGCAGCGCGAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTT
```


## AA sequence

Using Expasy and ORFfinder, we get a singular ORF, starting 69 nt in, and ending at the final nt, encoding for 751 amino acids, forming the P-element transposase:

```{bash, eval=FALSE}
MKYCKFCCKAVTGVKLIHVPKCAIKRKLWEQSLGCSLGENSQICDTHFND
SQWKAAPAKGQTFKRRRLNADAVPSKVIEPEPEKIKEGYTSGSTQTESCS
LFNENKSLREKIRTLEYEMRRLEQQLRESQQLEESLRKIFTDTQIRILKN
GGQRATFNSDDISTAICLHTAGPRAYNHLYKKGFPLPSRTTLYRWLSDVD
IKRGCLDVVIDLMDSDGVDDADKLCVLAFDEMKVAAAFEYDSSADIVYEP
SDYVQLAIVRGLKKSWKQPVFFDFNTRMDPDTLNNILRKLHRKGYLVVAI
VSDLGTGNQKLWTELGISESKTWFSHPADDHLKIFVFSDTPHLIKLVRNH
YVDSGLTINGKKLTKKTIQEALHLCNKSDLSILFKINENHINVRSLAKQK
VKLATQLFSNTTASSIRRCYSLGYDIENATETADFFKLMNDWFDIFNSKL
STSNCIECSQPYGKQLDIQNDILNRMSEIMRTGILDKPKRLPFQKGIIVN
NASLDGLYKYLQENFSMQYILTSRLNQDIVEHFFGSMRSRGGQFDHPTPL
QFKYRLRKYIIARNTEMLRNSGNIEEDNSESWLNLDFSSKENENKSKDDE
PVDDEPVDEMLSNIDFTEMDELTEDAMEYIAGYVIKKLRISDKVKENLTF
TYVDEVSHGGLIKPSEKFQEKLKELECIFLHYTNNNNFEITNNVKEKLIL
AARNVDVDKQVKSFYFKIRIYFRIKYFNKKIEIKNQKQKLIGNSKLLKIK
L
```

## KP element

Using the same extracted base sequence, we can further extract out the sequence of the KP element using the ID coordianates (807-2561):

```{bash, eval=FALSE}
GAGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTACGTGGAATAAAAAAAAATGAAATATTGCAAATTTTGCTGCAAAGCTGTGACTGGAGTAAAATTAATTCACGTGCCGAAGTGTGCTATTAAGAGAAAATTGTGGGAGCAGAGCCTTGGGTGCAGCCTTGGTGAAAACTCCCAAATTTGTGATACCCACTTTAATGATTCGCAGTGGAAGGCTGCACCTGCAAAAGGTCAGACATTTAAAAGGAGGCGACTCAACGCAGATGCCGTACCTAGTAAAGTGATAGAGCCTGAACCAGAAAAGATAAAAGAAGGCTATACCAGTGGGAGTACACAAACAGTCCTGTTCATTGTTTAATGAAAATAAGAGCTTGAGGGAAAAAATTCGTACTTTGGAGTACGAAATGCGTCGTTTAGAGCAGCAGCTGAGGGAGTCTCAACAGTTGGAGGAGTCTCTACGCAAAATCTTCACGGACACGCAGATACGGATACTGAAGAATGGTGGACAAAGAGCTACGTTCAATTCCGACGACATTTCTACAGCTATTTGTCTCCACACCGCAGGCCCTCGAGCGTATAACCATCTGTACAAAAAAGGATTTCCTTTGCCCAGTCGTACGACTTTGTACAGATGGTTATCAGATGTG|||INTERNAL-DELETION|||GAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTT
```

Which, when run on Expasy and ORFfinder, give us this AA sequence:

```{bash, eval=FALSE}
MKYCKFCCKAVTGVKLIHVPKCAIKRKLWEQSLGCSLGENSQICDTHFND
SQWKAAPAKGQTFKRRRLNADAVPSKVIEPEPEKIKEGYTSGSTQTESCS
LFNENKSLREKIRTLEYEMRRLEQQLRESQQLEESLRKIFTDTQIRILKN
GGQRATFNSDDISTAICLHTAGPRAYNHLYKKGFPLPSRTTLYRWLSDVE
TSMLINK
```

Providing 207 AA, and being identical to the canonical element for the first 199 AA, as has been described previously (Black et al)

## DMR2 IDs

### 314-2459

```{bash, eval=FALSE}
AGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTACGTGGAATAAAAAAAAATGAAATATTGCAAATTTTGCTGCAAAGCTGTGACTGGAGTAAAATTAATTCACGTGCCGAAGTGTGCTATTAAGAGAAAATTGTGGGAGCAGAGCCTTGGGTGCAGCCTTGGTGAAAACTCCCAAATTTGTGATACCCACTTTAATGATTCGCAGTGGAA

-ID-

AAGAGAAGTTAAAAGAGCTAGAATGTATTTTTTTGCATTATACAAATAATAATAATTTTGAAATTACAAATAATGTAAAGGAAAAATTAATATTAGCAGCGCGAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTTTAA
```

```{bash, eval=FALSE}
MKYCKFCCKAVTGVKLIHVPKCAIKRKLWEQSLGCSLGENSQICDTHFND
SQWKAAPAKGQTFKRRRLNADAVPSKVIEPEPEKIKEGYTSGSTQTESCS
LFNENKSLREKIRTLEYEMRRLEQQLRESQQLEESLMPPKLRTSSN-
```

PSC! - UAA at 2506

### 618-1544


```{bash, eval=FALSE}
AGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTACGTGGAATAAAAAAAAATGAAATATTGCAAATTTTGCTGCAAAGCTGTGACTGGAGTAAAATTAATTCACGTGCCGAAGTGTGCTATTAAGAGAAAATTGTGGGAGCAGAGCCTTGGGTGCAGCCTTGGTGAAAACTCCCAAATTTGTGATACCCACTTTAATGATTCGCAGTGGAAGGCTGCACCTGCAAAAGGTCAGACATTTAAAAGGAGGCGACTCAACGCAGATGCCGTACCTAGTAAAGTGATAGAGCCTGAACCAGAAAAGATAAAAGAAGGCTATACCAGTGGGAGTACACAAACAGA
GTCCTGTTCATTGTTTAATGAAAATAAGAGCTTGAGGGAAAAAATTCGTACTTTGGAGTACGAAATGCGTCGTTTAGAGCAGCAGCTGAGGGAGTCTCAACAGTTGGAGGAGTCTCT

-ID- 

AATGCCACCGAAACTGCGGACTTCTTCAAATTGATGAATGATTGGTTCGACATTTTTAATTCTAAATTGTCCACATCCAATTGCATTGAGTGCTCGCAACCTTATGGCAAGCAGTTGGATATACAGAATGATATTTTGAATCGAATGTCGGAAATTATGCGAACAGGAATTCTGGATAAACCCAAAAGGCTCCCATTTCAAAAAGGTATCATTGTGAATAATGCTTCGCTTGATGGCTTGTATAAATATTTGCAAGAAAACTTCAGTATGCAATACATATTAACAAGCCGTCTCAACCAAGACATTGTGGAGCATTTTTTTGGCAGCATGCGATCGAGAGGTGGACAATTCGACCATCCCACTCCACTGCAGTTTAAGTATAGGTTAAGAAAATATATAATAG
CCAGGAATACAGAAATGTTAAGAAATTCGGGAAATATCGAAGAGGACAACTCTGAAAGCTGGCTTAATTTAGATTTCAGTTCTAAAGAAAACGAAAATAAAAGTAAAGATGATGAGCCTGTCGATGATGAGCCTGTCGATGAGATGTTAAGCAATATAGATTTCACCGAAATGGATGAGTTGACGGAGGATGCGATGGAATATATCGCGGGCTATGTCATTAAAAAATTGAGAATCAGTGACAAAGTAAAAGAAAATTTGACATTTACATACGTCGACGAGGTGTCTCACGGCGGACTTATTAAGCCGTCCGAAAAATTTCAAGAGAAGTTAAAAGAGCTAGAATGTATTTTTTTGCATTATACAAATAATAATAATTTTGAAATTACAAATAATGTAAAGGAAAAATTAATATTAGCAGCGCGAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTTTAA
```

```{bash, eval=FALSE}
MKYCKFCCKAVTGVKLIHVPKCAIKRKLWEQSLGCSLGENSQICDTHFND
SQWKAAPAKGQTFKRRRLNADAVPSKVIEPEPEKIKEGYTSGSTQTESCS
LFNENKSLREKIRTLEYEMRRLEQQLRESQQLEESLMPPKLRTSSN-
```

PSC! - UGA at 1579

### 769-1780

```{bash, eval=FALSE}
AGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTACGTGGAATAAAAAAAAATGAAATATTGCAAATTTTGCTGCAAAGCTGTGACTGGAGTAAAATTAATTCACGTGCCGAAGTGTGCTATTAAGAGAAAATTGTGGGAGCAGAGCCTTGGGTGCAGCCTTGGTGAAAACTCCCAAATTTGTGATACCCACTTTAATGATTCGCAGTGGAAGGCTGCACCTGCAAAAGGTCAGACATTTAAAAGGAGGCGACTCAACGCAGATGCCGTACCTAGTAAAGTGATAGAGCCTGAACCAGAAAAGATAAAAGAAGGCTATACCAGTGGGAGTACACAAACAGA
GTCCTGTTCATTGTTTAATGAAAATAAGAGCTTGAGGGAAAAAATTCGTACTTTGGAGTACGAAATGCGTCGTTTAGAGCAGCAGCTGAGGGAGTCTCAACAGTTGGAGGAGTCTCTACGCAAAATCTTCACGGACACGCAGATACGGATACTGAAGAATGGTGGACAAAGAGCTACGTTCAATTCCGACGACATTTCTACAGCTATTTGTCTCCACACCGCAGGCCCTCGAGCGTATAACCATCTGTACAAAAAAGGATTTCCTTTG

-ID-

CTTGTATAAATATTTGCAAGAAAACTTCAGTATGCAATACATATTAACAAGCCGTCTCAACCAAGACATTGTGGAGCATTTTTTTGGCAGCATGCGATCGAGAGGTGGACAATTCGACCATCCCACTCCACTGCAGTTTAAGTATAGGTTAAGAAAATATATAATAG
CCAGGAATACAGAAATGTTAAGAAATTCGGGAAATATCGAAGAGGACAACTCTGAAAGCTGGCTTAATTTAGATTTCAGTTCTAAAGAAAACGAAAATAAAAGTAAAGATGATGAGCCTGTCGATGATGAGCCTGTCGATGAGATGTTAAGCAATATAGATTTCACCGAAATGGATGAGTTGACGGAGGATGCGATGGAATATATCGCGGGCTATGTCATTAAAAAATTGAGAATCAGTGACAAAGTAAAAGAAAATTTGACATTTACATACGTCGACGAGGTGTCTCACGGCGGACTTATTAAGCCGTCCGAAAAATTTCAAGAGAAGTTAAAAGAGCTAGAATGTATTTTTTTGCATTATACAAATAATAATAATTTTGAAATTACAAATAATGTAAAGGAAAAATTAATATTAGCAGCGCGAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTTTAA

```

```{bash, eval=FALSE}
MKYCKFCCKAVTGVKLIHVPKCAIKRKLWEQSLGCSLGENSQICDTHFND
SQWKAAPAKGQTFKRRRLNADAVPSKVIEPEPEKIKEGYTSGSTQTESCS
LFNENKSLREKIRTLEYEMRRLEQQLRESQQLEESLRKIFTDTQIRILKN
GGQRATFNSDDISTAICLHTAGPRAYNHLYKKGFPLLV-
```

PSC! - UAA at 1939

## Other IDs

### 137-1282


```{bash, eval=FALSE}
AGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTA

-ID- 

GCCACATTTAATTAAGTTAGTCCGTAACCACTATGTGGATTCCGGATTAACAATAAATGGGAAAAAATTAACAAAAAAAACAATTCAGGAGGCACTTCATCTTTGCAACAAGTCCGATCTGTCTATCCTCTTTAAAATTAATGAAAATCACATTAATGTTCGATCGCTCGCAAAACAGAAGGTTAAATTGGCTACCCAGCTGTTTTCGAATACCACCGCTAGCTCGATCAGACGCTGCTATTCATTGGGGTATGACATTGAAAATGCCACCGAAACTGCGGACTTCTTCAAATTGATGAATGATTGGTTCGACATTTTTAATTCTAAATTGTCCACATCCAATTGCATTGAGTGCTCGCAACCTTATGGCAAGCAGTTGGATATACAGAATGATATTTTGAATCGAATGTCGGAAATTATGCGAACAGGAATTCTGGATAAACCCAAAAGGCTCCCATTTCAAAAAGGTATCATTGTGAATAATGCTTCGCTTGATGGCTTGTATAAATATTTGCAAGAAAACTTCAGTATGCAATACATATTAACAAGCCGTCTCAACCAAGACATTGTGGAGCATTTTTTTGGCAGCATGCGATCGAGAGGTGGACAATTCGACCATCCCACTCCACTGCAGTTTAAGTATAGGTTAAGAAAATATATAATAG
CCAGGAATACAGAAATGTTAAGAAATTCGGGAAATATCGAAGAGGACAACTCTGAAAGCTGGCTTAATTTAGATTTCAGTTCTAAAGAAAACGAAAATAAAAGTAAAGATGATGAGCCTGTCGATGATGAGCCTGTCGATGAGATGTTAAGCAATATAGATTTCACCGAAATGGATGAGTTGACGGAGGATGCGATGGAATATATCGCGGGCTATGTCATTAAAAAATTGAGAATCAGTGACAAAGTAAAAGAAAATTTGACATTTACATACGTCGACGAGGTGTCTCACGGCGGACTTATTAAGCCGTCCGAAAAATTTCAAGAGAAGTTAAAAGAGCTAGAATGTATTTTTTTGCATTATACAAATAATAATAATTTTGAAATTACAAATAATGTAAAGGAAAAATTAATATTAGCAGCGCGAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTTTAA

```

No ORFs

### 903-1393

```{bash, eval=FALSE}
AGAGGAAAGGTTGTGTGCGGACGAATTTTTTTTTGAAAACATTAACCCTTACGTGGAATAAAAAAAAATGAAATATTGCAAATTTTGCTGCAAAGCTGTGACTGGAGTAAAATTAATTCACGTGCCGAAGTGTGCTATTAAGAGAAAATTGTGGGAGCAGAGCCTTGGGTGCAGCCTTGGTGAAAACTCCCAAATTTGTGATACCCACTTTAATGATTCGCAGTGGAAGGCTGCACCTGCAAAAGGTCAGACATTTAAAAGGAGGCGACTCAACGCAGATGCCGTACCTAGTAAAGTGATAGAGCCTGAACCAGAAAAGATAAAAGAAGGCTATACCAGTGGGAGTACACAAACAGA
GTCCTGTTCATTGTTTAATGAAAATAAGAGCTTGAGGGAAAAAATTCGTACTTTGGAGTACGAAATGCGTCGTTTAGAGCAGCAGCTGAGGGAGTCTCAACAGTTGGAGGAGTCTCTACGCAAAATCTTCACGGACACGCAGATACGGATACTGAAGAATGGTGGACAAAGAGCTACGTTCAATTCCGACGACATTTCTACAGCTATTTGTCTCCACACCGCAGGCCCTCGAGCGTATAACCATCTGTACAAAAAAGGATTTCCTTTGCCCAGTCGTACGACTTTGTACAGATGGTTATCAGATGTGGACATAAAAAGAGGATGTTTGGATGTGGTCATAGACCTAATGGACAGTGATGGAGTTGATGACGCCGACAAGCTTTGCGTACTCGCTTTCGACGA

-ID-

GTCCGATCTGTCTATCCTCTTTAAAATTAATGAAAATCACATTAATGTTCGATCGCTCGCAAAACAGAAGGTTAAATTGGCTACCCAGCTGTTTTCGAATACCACCGCTAGCTCGATCAGACGCTGCTATTCATTGGGGTATGACATTGAAAATGCCACCGAAACTGCGGACTTCTTCAAATTGATGAATGATTGGTTCGACATTTTTAATTCTAAATTGTCCACATCCAATTGCATTGAGTGCTCGCAACCTTATGGCAAGCAGTTGGATATACAGAATGATATTTTGAATCGAATGTCGGAAATTATGCGAACAGGAATTCTGGATAAACCCAAAAGGCTCCCATTTCAAAAAGGTATCATTGTGAATAATGCTTCGCTTGATGGCTTGTATAAATATTTGCAAGAAAACTTCAGTATGCAATACATATTAACAAGCCGTCTCAACCAAGACATTGTGGAGCATTTTTTTGGCAGCATGCGATCGAGAGGTGGACAATTCGACCATCCCACTCCACTGCAGTTTAAGTATAGGTTAAGAAAATATATAATAG
CCAGGAATACAGAAATGTTAAGAAATTCGGGAAATATCGAAGAGGACAACTCTGAAAGCTGGCTTAATTTAGATTTCAGTTCTAAAGAAAACGAAAATAAAAGTAAAGATGATGAGCCTGTCGATGATGAGCCTGTCGATGAGATGTTAAGCAATATAGATTTCACCGAAATGGATGAGTTGACGGAGGATGCGATGGAATATATCGCGGGCTATGTCATTAAAAAATTGAGAATCAGTGACAAAGTAAAAGAAAATTTGACATTTACATACGTCGACGAGGTGTCTCACGGCGGACTTATTAAGCCGTCCGAAAAATTTCAAGAGAAGTTAAAAGAGCTAGAATGTATTTTTTTGCATTATACAAATAATAATAATTTTGAAATTACAAATAATGTAAAGGAAAAATTAATATTAGCAGCGCGAAACGTCGATGTTGATAAACAAGTAAAATCTTTTTATTTTAAAATTAGAATATATTTTAGAATTAAGTACTTCAACAAAAAAATTGAAATTAAAAATCAAAAACAAAAGTTAATTGGAAACTCCAAATTATTAAAAATAAAACTTTAA

```

```{bash, eval=FALSE}
MKYCKFCCKAVTGVKLIHVPKCAIKRKLWEQSLGCSLGENSQICDTHFND
SQWKAAPAKGQTFKRRRLNADAVPSKVIEPEPEKIKEGYTSGSTQTESCS
LFNENKSLREKIRTLEYEMRRLEQQLRESQQLEESLRKIFTDTQIRILKN
GGQRATFNSDDISTAICLHTAGPRAYNHLYKKGFPLPSRTTLYRWLSDVD
IKRGCLDVVIDLMDSDGVDDADKLCVLAFDESDLSILFKINENHINVRSL
AKQKVKLATQLFSNTTASSIRRCYSLGYDIENATETADFFKLMNDWFDIF
NSKLSTSNCIECSQPYGKQLDIQNDILNRMSEIMRTGILDKPKRLPFQKG
IIVNNASLDGLYKYLQENFSMQYILTSRLNQDIVEHFFGSMRSRGGQFDH
PTPLQFKYRLRKYIIARNTEMLRNSGNIEEDNSESWLNLDFSSKENENKS
KDDEPVDDEPVDEMLSNIDFTEMDELTEDAMEYIAGYVIKKLRISDKVKE
NLTFTYVDEVSHGGLIKPSEKFQEKLKELECIFLHYTNNNNFEITNNVKE
KLILAARNVDVDKQVKSFYFKIRIYFRIKYFNKKIEIKNQKQKLIGNSKL
LKIKL
```

In-frame

## Frameshift calc - example

(ID End - (ID Start + 1) - Length of intron(s) between start & end) / 3

E.g.

ID: 983-2458

(2458 - (983 + 1) - 53 - 190) / 3 = 411 

Integer = in-frame
.333 = +1
.666 = +2
